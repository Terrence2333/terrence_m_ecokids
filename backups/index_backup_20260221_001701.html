{% extends "base.html" %}
{% block content %}
<canvas id="noise-canvas" style="position: fixed; inset: 0; z-index: 20000; pointer-events: none; opacity: 0; transition: opacity 0.1s;"></canvas>

<div id="master-bg" style="position: fixed; inset: 0; z-index: -1; background: #000; overflow: hidden;">
    <canvas id="main-canvas" style="position: absolute; inset: 0; opacity: 0.3;"></canvas>
    <div id="laser-line" style="position: absolute; width: 100%; height: 1px; background: #ff4500; box-shadow: 0 0 15px #ff4500; top: -10px; z-index: 1; opacity: 0;"></div>
</div>

<nav style="position: fixed; top: 0; left: 0; width: 100%; height: 80px; background: #000; border-bottom: 2px solid #d4af37; display: flex; justify-content: space-around; align-items: center; z-index: 1000; font-family: 'Orbitron', sans-serif; letter-spacing: 8px; color: #d4af37; font-size: 0.9rem; font-weight: bold;">
    <span>HOME</span><span>UNIDADES</span><span>NODOS</span><span>IMPERIO</span><span>PAGOS</span>
</nav>

<div id="main-interface" style="padding: 120px 5% 0; display: grid; grid-template-columns: 1.2fr 1fr; gap: 20px; font-family: 'Orbitron', sans-serif; opacity: 0; transition: opacity 1s;">
    
    <div style="padding-top: 40px;">
        <h1 style="font-size: 4.5rem; color: #fff; margin: 0; letter-spacing: 12px; font-weight: 900; text-transform: uppercase;">TERRENCE M</h1>
        <div style="color: #d4af37; line-height: 2.2; font-size: 0.85rem; margin-top: 30px; font-family: monospace; letter-spacing: 1px;">
            <p>> KERNEL: 0x8899-OMNI-V3</p>
            <p style="color: #d4af37;">INGENIERÍA SUSTENTABLE DE ÉLITE</p>
            <p>> STATUS: <span style="color: #0f0; text-shadow: 0 0 10px #0f0;">STABLE</span></p>
            <p>> X: <span id="coord-lat">0491</span> | Y: <span id="coord-lon">0155</span></p>
            <p>> SECURE_TIME: <span id="sec-time">7s</span></p>
            <p>> NODES: ACTIVE_PROTECTION</p>
            <a href="#" style="color: #3366ff; text-decoration: none; font-size: 0.75rem; border-bottom: 1px solid #3366ff; padding-bottom: 2px;">ACCEDER AL NÚCLEO</a>
        </div>
    </div>

    <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 40px;">
        <div style="border: 1px solid #d4af37; padding: 25px; background: rgba(0,0,0,0.7); width: 320px; position: relative;">
            <div style="width: 160px; height: 160px; border-radius: 50%; border: 4px solid #0f0; overflow: hidden; margin: 0 auto; box-shadow: 0 0 25px rgba(0,255,0,0.3);">
                <video id="webcam" autoplay playsinline muted style="width:100%; height:100%; object-fit:cover; filter: contrast(1.2) brightness(1.1);"></video>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <p style="color: #0f0; font-size: 0.7rem; margin: 0; letter-spacing: 2px; font-weight: bold;">ID: DIRECTOR_TERRENCE_M</p>
                <p style="color: #555; font-size: 0.55rem; margin: 5px 0 0;">AUTH_LVL: OMNIPRESENTE</p>
            </div>
        </div>

        <div style="display: flex; gap: 50px; color: #fff; text-align: center; padding-right: 20px;">
            <div>
                <div style="font-size: 2.2rem; font-weight: 900; color: #d4af37;">4500+</div>
                <div style="font-size: 0.55rem; color: #888; letter-spacing: 1px;">CO2 REDUCIDO</div>
            </div>
            <div>
                <div style="font-size: 2.2rem; font-weight: 900; color: #d4af37;">1250+</div>
                <div style="font-size: 0.55rem; color: #888; letter-spacing: 1px;">MW GENERADOS</div>
            </div>
        </div>
    </div>
</div>

<div style="position: fixed; bottom: 100px; left: 5%; width: 350px; border: 2px solid #d4af37; padding: 15px; background: rgba(0,0,0,0.5); text-align: center;">
    <h2 style="color: #fff; font-family: 'Orbitron'; letter-spacing: 8px; margin: 0; font-size: 1.2rem;">SHIELD: STANDBY</h2>
</div>

<div id="chat-container" style="position:fixed; bottom:20px; right:20px; width:360px; background:rgba(0,0,0,0.95); border:1px solid #ff4500; z-index:2000; box-shadow: 0 0 30px #000;">
    <div id="chat-box" style="height:140px; overflow-y:auto; padding:12px; font-size:0.75rem; color:#fff; font-family: monospace; border-bottom: 1px solid #222;"></div>
    <canvas id="seismograph" style="width: 100%; height: 40px; background: #000;"></canvas>
    <div style="display: flex; background: #000;">
        <input type="text" id="user-input" placeholder="EJECUTAR ORDEN..." style="flex: 1; background:transparent; border:none; color:#ff4500; padding:12px; font-family: monospace; outline: none;">
        <button onclick="sendMsg()" style="background:#ff4500; border:none; color:#000; font-weight:bold; padding: 0 15px; cursor: pointer;">EXE</button>
    </div>
</div>

<div style="position: fixed; bottom: 20px; width: 100%; text-align: center; color: rgba(255,255,255,0.2); font-size: 0.5rem; letter-spacing: 4px; font-family: monospace;">
    INTERFACE SUPREMA | terrence.m | SECURITY: GOD_LEVEL | 2026
</div>

<style>
    body { background: #000; margin: 0; overflow: hidden; }
    @keyframes laserSweep { 0% { top: 0%; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }
    .laser-active { animation: laserSweep 5s linear infinite; }
    #chat-box::-webkit-scrollbar { width: 3px; }
    #chat-box::-webkit-scrollbar-thumb { background: #ff4500; }
</style>

<script>
    // INICIAR CÁMARA
    navigator.mediaDevices.getUserMedia({ video: true }).then(s => { 
        document.getElementById('webcam').srcObject = s; 
    }).catch(e => console.log("Cámara no detectada"));

    // GLOBO RADAR
    const canvas = document.getElementById('main-canvas'), ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    let globeRot = 0;
    function draw() {
        ctx.fillStyle = "black"; ctx.fillRect(0,0,canvas.width, canvas.height);
        const cX = canvas.width/2, cY = canvas.height/2, r = 320;
        ctx.strokeStyle = "rgba(212,175,55,0.12)";
        for(let i=0; i<18; i++) {
            ctx.beginPath(); ctx.ellipse(cX, cY, Math.abs(r * Math.sin(globeRot + i)), r, 0, 0, Math.PI*2); ctx.stroke();
        }
        globeRot += 0.002; requestAnimationFrame(draw);
    }
    draw();

    // SISMÓGRAFO
    const sCanvas = document.getElementById('seismograph'), sCtx = sCanvas.getContext('2d');
    let xS = 0;
    function drawSeismo() {
        sCtx.fillStyle = "rgba(0,0,0,0.1)"; sCtx.fillRect(0,0,sCanvas.width, sCanvas.height);
        sCtx.strokeStyle = "#ff4500"; sCtx.beginPath(); sCtx.moveTo(xS, 20);
        sCtx.lineTo(xS+2, 20+(Math.random()*20-10)); sCtx.stroke(); xS += 2;
        if(xS > sCanvas.width) xS = 0;
        requestAnimationFrame(drawSeismo);
    }
    drawSeismo();

    // CHAT FUNCIONAL
    function sendMsg() {
        const i = document.getElementById('user-input'), b = document.getElementById('chat-box');
        if(!i.value) return;
        b.innerHTML += `<div style="margin-bottom:5px; color:#0f0;">> ${i.value}</div>`;
        i.value = ""; b.scrollTop = b.scrollHeight;
    }

    // INTERFAZ ACTIVA
    window.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => { document.getElementById('main-interface').style.opacity = '1'; }, 500);
        document.getElementById('laser-line').classList.add('laser-active');
    });
</script>
{% endblock %}