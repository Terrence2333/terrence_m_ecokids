{% extends "base.html" %}
{% block content %}
<canvas id="noise-canvas" style="position: fixed; inset: 0; z-index: 20000; pointer-events: none; opacity: 0;"></canvas>

<div id="boot-screen" style="position: fixed; inset: 0; background: #000; z-index: 10000; display: flex; flex-direction: column; justify-content: center; align-items: center; font-family: 'Orbitron', sans-serif; color: #d4af37;">
    <div id="loader-ring" style="width: 140px; height: 140px; border: 1px solid #111; border-top: 5px solid #ff4500; border-radius: 50%; animation: spin 0.4s linear infinite;"></div>
    <div id="boot-log" style="width: 600px; height: 150px; font-size: 0.6rem; color: #ff4500; overflow: hidden; margin-top: 40px; border: 1px solid rgba(255,69,0,0.2); padding: 20px; background: rgba(0,0,0,0.9); font-family: monospace;"></div>
    <p style="font-size: 0.55rem; letter-spacing: 15px; margin-top: 25px; color: #d4af37;">LOAD_MONITOR_ACTIVE : <span id="percent">0</span>%</p>
</div>

<div id="main-interface" style="display: flex; justify-content: space-between; padding: 40px 5%; height: 85vh; position: relative; z-index: 1; opacity: 0; visibility: hidden; transition: opacity 2s;">
    <div style="width: 320px;">
        <div id="core-circle" style="position: relative; width: 260px; height: 260px; border: 4px solid #d4af37; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.95);">
            <h1 style="font-size: 2.3rem; font-weight: 900; color: #d4af37; text-shadow: 0 0 20px #d4af37;">TERRENCE M</h1>
        </div>
        <div style="margin-top: 40px; background: rgba(0,0,0,0.9); border-left: 10px solid #ff4500; padding: 25px;">
            <p style="color:#ff4500; font-weight: 900; font-size: 0.7rem;">[ CPU_LOAD_WATCHER ]</p>
            <div id="cpu-status" style="font-family: 'Orbitron'; color: #0f0; font-size: 0.9rem;">SISTEMA ESTABLE</div>
        </div>
    </div>
    
    <div id="chat-container" style="position:fixed; bottom:80px; right:30px; width:430px; background:rgba(0,0,0,0.98); border:2px solid #ff4500; z-index:1000; visibility: hidden;">
        <div style="background:#ff4500; color:#000; padding:15px; font-weight:900;">RADAR_WATCHDOG_TM</div>
        <div id="chat-box" style="height:200px; overflow-y:auto; padding:20px; font-size:0.7rem; color:#fff; font-family: monospace;"></div>
        <div style="display:flex; border-top:1px solid #ff4500;">
            <input type="text" id="user-input" placeholder="ORDEN..." style="flex:1; background:#000; border:none; color:#fff; padding:15px; outline:none;">
            <button onclick="sendMessage()" style="background:#ff4500; border:none; padding:0 25px; cursor:pointer;">EXE</button>
        </div>
    </div>
</div>

<script>
    let selfDestruct = false;
    function triggerSelfDestruct(cmd) {
        selfDestruct = true;
        document.getElementById('noise-canvas').style.opacity = "0.8";
        fetch('/log_intrusion', {method: 'POST', body: JSON.stringify({command: cmd})});
        setTimeout(() => { location.reload(); }, 2500);
    }

    function sendMessage() {
        const i = document.getElementById('user-input'), b = document.getElementById('chat-box');
        const v = i.value.toLowerCase();
        if(v.includes("admin") || v.includes("hack")) {
            triggerSelfDestruct(i.value);
        } else {
            b.innerHTML += `<p style="color:#ff4500">> ${i.value}</p>`;
        }
        i.value = ""; b.scrollTop = b.scrollHeight;
    }

    window.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => {
            document.getElementById('boot-screen').style.display = 'none';
            document.getElementById('main-interface').style.visibility = 'visible';
            document.getElementById('main-interface').style.opacity = '1';
            document.getElementById('chat-container').style.visibility = 'visible';
        }, 1500);
    });
</script>
{% endblock %}
